@model List<Iot_WebApp.Models.SensorData>
@{
    ViewData["Title"] = "Home Page";
    var persianCalendar = new System.Globalization.PersianCalendar();
}

<!-- Include Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<!-- Include your custom CSS -->
<link href="~/css/custom.css" rel="stylesheet">

<h1 class="mt-5"> مانیتورینگ دما و رطوبت گلخانه </h1>

<form method="get" class="mt-3">
    <div class="form-row">
        <div class="col">
            <input type="number" class="form-control" name="minTemperature" placeholder="دمای کمینه">
        </div>
        <div class="col">
            <input type="number" class="form-control" name="maxTemperature" placeholder="دمای بیشینه">
        </div>
        <div class="col">
            <input type="number" class="form-control" name="minHumidity" placeholder="رطوبت کمینه">
        </div>
        <div class="col">
            <input type="number" class="form-control" name="maxHumidity" placeholder="رطوبت بیشینه">
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">فیلتر</button>
        </div>
    </div>
</form>

<div class="table-responsive">
    <table class="table table-striped table-bordered mt-4">
        <thead class="thead-dark">
            <tr>
                <th>(دما(سلسیوس</th>
                <th>(رطوبت(درصد</th>
                <th>مورخ</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                // Convert Gregorian date to Shamsi date
                var shamsiDate = $"{persianCalendar.GetYear(item.Timestamp)}/{persianCalendar.GetMonth(item.Timestamp).ToString("00")}/{persianCalendar.GetDayOfMonth(item.Timestamp).ToString("00")} {item.Timestamp:HH:mm:ss}";

                if (@item.Temperature > 35)
                {
                    <tr style="background-color:red">
                        <td>@item.Temperature</td>
                        <td>@item.Humidity</td>
                        <td>@shamsiDate</td>
                    </tr>
                }
                else
                {
                    <tr>
                        <td>@item.Temperature</td>
                        <td>@item.Humidity</td>
                        <td>@shamsiDate</td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>
